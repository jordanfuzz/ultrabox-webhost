on:
  push:
    branches:
      - master
  repository_dispatch:
    types: [default]
jobs:
  deploy:
    name: deploy
    runs-on: self-hosted
    steps:
      - name: checkout
        uses: actions/checkout@v3
      - name: stop and remove existing container
        run: docker stop ultrabox-webhost && docker rm --force ultrabox-webhost || true
      - name: build
        run: docker build --no-cache -t ultrabox-webhost .
      - name: start nginx
        run: docker run -dp 80:80 --rm --name ultrabox-webhost ultrabox-webhost
